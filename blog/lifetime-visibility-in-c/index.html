<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>Lifetime and Visibility in C Programs</title><meta content="Lifetime and Visibility in C Programs" name=title><meta content=Karthik name=author><meta content="Personal Commentary" name=description><meta content=website property=og:type><meta content=https://Karthik-d-k.github.io/blog/lifetime-visibility-in-c/ property=og:url><meta content=0x646b property=og:site_name><meta content="Lifetime and Visibility in C Programs" property=og:title><meta content="Personal Commentary" property=og:description><meta content=https://Karthik-d-k.github.io/favicon.ico property=og:image><meta content=summary_large_image property=twitter:card><meta content=https://Karthik-d-k.github.io/blog/lifetime-visibility-in-c/ property=twitter:url><meta content="Lifetime and Visibility in C Programs" property=twitter:title><meta content="Personal Commentary" property=twitter:description><meta content=https://Karthik-d-k.github.io/favicon.ico property=twitter:image><link href=https://Karthik-d-k.github.io/blog/lifetime-visibility-in-c/ rel=canonical><link rel="shortcut icon" href=https://Karthik-d-k.github.io/favicon.ico type=image/x-icon><link href=https://Karthik-d-k.github.io/atom.xml rel=alternate title=RSS type=application/atom+xml><link href=https://speyll.github.io/suCSS/reset-min.css rel=stylesheet><link href=https://speyll.github.io/suCSS/suCSS-min.css rel=stylesheet><link href=https://Karthik-d-k.github.io/css/style.css rel=stylesheet><script defer src=https://Karthik-d-k.github.io/js/script.js></script><body><header><nav id=nav-bar><a href=/> /home </a><a href=/blog> /blog </a><a href=/til> /til </a><a href=/projects> /projects </a><a href=/tags> /tags </a><a href=/bookmarks> /bookmarks </a><a href=/cv> /cv </a><div><input id=theme-toggle style=display:none type=checkbox><label for=theme-toggle id=theme-toggle-label><svg class=icons id=theme-icon><use href=https://Karthik-d-k.github.io/icons.svg#lightMode></use></svg></label><audio id=theme-sound><source src=https://Karthik-d-k.github.io/click.ogg type=audio/ogg></audio></div></nav></header><main><h1>Lifetime and Visibility in C Programs</h1><h2 id=motivation>Motivation</h2><p>I would like to explain how different <strong>keywords in C</strong> especially <code>static</code> and <code>extern</code> plays key role in defining the lifetime and visibility of objects. This has been ever confusing topic for me whenever i come across such keywords in real world code. This is my understanding and explanation as to when/how to use such keywords and how to reason about the same.<h2 id=basic-exploration>Basic Exploration</h2><p>Firstly, i will define the terms “Lifetime” and “Visibility” as follows:<blockquote><p><strong>Lifetime</strong>: Every object has <strong>start and end point</strong> beyond which we can’t/shouldn’t access it. In other words it refers to <em>Storage duration</em> of an object.</blockquote><blockquote><p><strong>Visibility</strong>: An object can/should be accessed from <strong>inside block</strong> or <strong>inside file</strong> or from other <strong>translation units [.c source files]</strong> only according to its visibility. In other words it refers to <em>Linkage</em> of an object.</blockquote><p>I will thoroughly explain the concepts with each <strong>keywords</strong> along the lines of above definition.<h3 id=static>static</h3><p><u>Lifetime</u>: Changes the lifetime to <strong>Static storage duration</strong> meaning it will be stored in memory till the end of the program. This applies even for the object’s which are in file scope (local) and/or block scope (global).<p><u>Visibility</u>: Set’s the objects to <strong>Internal linkage</strong>, i.e, object is accessible only within current translation unit.<ul><li><p>Un-initialized static objects will be automatically initialized to 0.</p><li><p>static local variables will be initialized only once and retains its value between function calls.</p></ul><p><strong>Snippet 1:</strong><pre class=language-c data-lang=c style=color:#c0c5ce;background-color:#2b303b><code class=language-c data-lang=c><span style=color:#b48ead>#include </span><span><</span><span style=color:#a3be8c>stdio.h</span><span>>
</span><span>
</span><span style=color:#b48ead>void </span><span style=color:#8fa1b3>func</span><span>() {
</span><span>    </span><span style=color:#b48ead>static int</span><span> count = </span><span style=color:#d08770>0</span><span>; </span><span style=color:#65737e>// static local variable
</span><span>    count++;
</span><span>    </span><span style=color:#96b5b4>printf</span><span>("</span><span style=color:#a3be8c>Count: </span><span style=color:#d08770>%d</span><span style=color:#96b5b4>\n</span><span>", count);
</span><span>}
</span><span>
</span><span style=color:#b48ead>int </span><span style=color:#8fa1b3>main</span><span>() {
</span><span>    </span><span style=color:#bf616a>func</span><span>(); </span><span style=color:#65737e>// Output: Count: 1
</span><span>    </span><span style=color:#bf616a>func</span><span>(); </span><span style=color:#65737e>// Output: Count: 2
</span><span>    </span><span style=color:#bf616a>func</span><span>(); </span><span style=color:#65737e>// Output: Count: 3
</span><span>
</span><span>    </span><span style=color:#b48ead>return </span><span style=color:#d08770>0</span><span>;
</span><span>}
</span></code></pre><p><strong>Snippet 1 stdout:</strong><pre style=color:#c0c5ce;background-color:#2b303b><code><span>Count: 1
</span><span>Count: 2
</span><span>Count: 3
</span></code></pre><blockquote><p>In this example, the count variable is declared as static inside the func function. It retains its value between function calls, demonstrating static storage duration and internal linkage.</blockquote><h3 id=extern>extern</h3><p><u>Lifetime</u>: Changes the lifetime to <strong>Static storage duration</strong> meaning it will be stored in memory till the end of the program. This applies even for the object’s which are in file scope (local) and/or block scope (global).<p><u>Visibility</u>: Set’s the objects to <strong>External linkage</strong>, i.e, object is accessible to other current translation units.<ul><li>By default all functions and global variables will be set to extern unless otherwise overwritten.</ul><p><strong>Snippet 2:</strong><p>File: <code>main.c</code><pre class=language-c data-lang=c style=color:#c0c5ce;background-color:#2b303b><code class=language-c data-lang=c><span style=color:#b48ead>#include </span><span><</span><span style=color:#a3be8c>stdio.h</span><span>>
</span><span>
</span><span style=color:#b48ead>extern int</span><span> globalVar; </span><span style=color:#65737e>// Declaration of an external variable
</span><span>
</span><span style=color:#b48ead>int </span><span style=color:#8fa1b3>main</span><span>() {
</span><span>    </span><span style=color:#96b5b4>printf</span><span>("</span><span style=color:#a3be8c>Global Variable: </span><span style=color:#d08770>%d</span><span style=color:#96b5b4>\n</span><span>", globalVar);
</span><span>    
</span><span>    </span><span style=color:#b48ead>return </span><span style=color:#d08770>0</span><span>;
</span><span>}
</span></code></pre><p>File: <code>global.c</code><pre class=language-c data-lang=c style=color:#c0c5ce;background-color:#2b303b><code class=language-c data-lang=c><span style=color:#b48ead>int</span><span> globalVar = </span><span style=color:#d08770>42</span><span>; </span><span style=color:#65737e>// Definition of the external variable
</span></code></pre><p><strong>Snippet 2 stdout:</strong><pre style=color:#c0c5ce;background-color:#2b303b><code><span>Global Variable: 42
</span></code></pre><blockquote><p>In this example, globalVar is declared as extern in main.c and defined in global.c. This demonstrates external linkage, allowing the variable to be accessed across different translation units.</blockquote><h2 id=advanced-exploration>Advanced Exploration</h2><p><strong>Scenario 1:</strong> <em>Let’s say we have to create user defined type and the object with this type has to be shared among different source files.</em><ul><li>User defined type has to be defined inside an <code>h file</code> and the object should be defined with <code>extern</code> keyword.<li>extern will make sure the object is accessible among all source files which includes this header file.<li>type information will also be available in the same source file because of inclusion of this header file.</ul><p><strong>Snippet 3:</strong><p>File: <code>types.h</code><pre class=language-c data-lang=c style=color:#c0c5ce;background-color:#2b303b><code class=language-c data-lang=c><span style=color:#b48ead>#ifndef</span><span> TYPES_H
</span><span style=color:#b48ead>#define </span><span>TYPES_H
</span><span>
</span><span style=color:#b48ead>typedef struct </span><span>{
</span><span>    </span><span style=color:#b48ead>int</span><span> id;
</span><span>    </span><span style=color:#b48ead>char</span><span> name[</span><span style=color:#d08770>50</span><span>];
</span><span>} User;
</span><span>
</span><span style=color:#b48ead>extern</span><span> User user; </span><span style=color:#65737e>// Declaration of an external variable of user-defined type
</span><span>
</span><span style=color:#b48ead>#endif </span><span style=color:#65737e>// TYPES_H
</span></code></pre><p>File: <code>main.c</code><pre class=language-c data-lang=c style=color:#c0c5ce;background-color:#2b303b><code class=language-c data-lang=c><span style=color:#b48ead>#include </span><span><</span><span style=color:#a3be8c>stdio.h</span><span>>
</span><span style=color:#b48ead>#include </span><span>"</span><span style=color:#a3be8c>types.h</span><span>"
</span><span>
</span><span style=color:#b48ead>int </span><span style=color:#8fa1b3>main</span><span>() {
</span><span>    </span><span style=color:#96b5b4>printf</span><span>("</span><span style=color:#a3be8c>User ID: </span><span style=color:#d08770>%d</span><span style=color:#96b5b4>\n</span><span>", user.</span><span style=color:#bf616a>id</span><span>);
</span><span>    </span><span style=color:#96b5b4>printf</span><span>("</span><span style=color:#a3be8c>User Name: </span><span style=color:#d08770>%s</span><span style=color:#96b5b4>\n</span><span>", user.</span><span style=color:#bf616a>name</span><span>);
</span><span>    
</span><span>    </span><span style=color:#b48ead>return </span><span style=color:#d08770>0</span><span>;
</span><span>}
</span></code></pre><p>File: <code>user.c</code><pre class=language-c data-lang=c style=color:#c0c5ce;background-color:#2b303b><code class=language-c data-lang=c><span style=color:#b48ead>#include </span><span>"</span><span style=color:#a3be8c>types.h</span><span>"
</span><span>
</span><span>User user = {</span><span style=color:#d08770>1</span><span>, "</span><span style=color:#a3be8c>John Doe</span><span>"}; </span><span style=color:#65737e>// Definition of the external variable
</span></code></pre><p><strong>Snippet 3 stdout:</strong><pre style=color:#c0c5ce;background-color:#2b303b><code><span>User ID: 1
</span><span>User Name: John Doe
</span></code></pre><blockquote><p>In this example, the User type is defined in a header file types.h, and the user variable is declared as extern. The variable is defined in user.c and accessed in main.c, demonstrating external linkage and sharing of user-defined types across different source files.</blockquote><p><strong>Scenario 2:</strong> <em>Let’s say we have to create a user-defined function that should be encapsulated and shouldn’t be shared with other source files.</em><ul><li>If we define a function in a header (.h) file and include it in multiple source files, it can be used in all those source files because, by default, all functions have extern linkage unless explicitly changed.<li>To limit the visibility of a function to the current source file, we use the <code>static</code> keyword. This ensures the function can only be used within that single file. It is important to define the function in a .c file, not in a .h file, so that when the .h file is included in multiple source files, the function remains inaccessible.</ul><p><strong>Snippet 4:</strong><p>File: <code>utils.c</code><pre class=language-c data-lang=c style=color:#c0c5ce;background-color:#2b303b><code class=language-c data-lang=c><span style=color:#b48ead>#include </span><span>"</span><span style=color:#a3be8c>utils.h</span><span>"
</span><span>
</span><span style=color:#b48ead>static void </span><span style=color:#8fa1b3>helperFunction</span><span>() {
</span><span>    </span><span style=color:#65737e>// Function implementation
</span><span>}
</span><span>
</span><span style=color:#b48ead>void </span><span style=color:#8fa1b3>publicFunction</span><span>() {
</span><span>    </span><span style=color:#bf616a>helperFunction</span><span>(); </span><span style=color:#65737e>// Can call the static function within the same file
</span><span>}
</span></code></pre><p>File: <code>utils.h</code><pre class=language-c data-lang=c style=color:#c0c5ce;background-color:#2b303b><code class=language-c data-lang=c><span style=color:#b48ead>#ifndef</span><span> UTILS_H
</span><span style=color:#b48ead>#define </span><span>UTILS_H
</span><span>
</span><span style=color:#b48ead>void </span><span style=color:#8fa1b3>publicFunction</span><span>(); </span><span style=color:#65737e>// Only declare the public function here
</span><span>
</span><span style=color:#b48ead>#endif </span><span style=color:#65737e>// UTILS_H
</span></code></pre><p>File: <code>main.c</code><pre class=language-c data-lang=c style=color:#c0c5ce;background-color:#2b303b><code class=language-c data-lang=c><span style=color:#b48ead>#include </span><span>"</span><span style=color:#a3be8c>utils.h</span><span>"
</span><span>
</span><span style=color:#b48ead>int </span><span style=color:#8fa1b3>main</span><span>() {
</span><span>    </span><span style=color:#bf616a>publicFunction</span><span>(); </span><span style=color:#65737e>// Can call the public function
</span><span>    </span><span style=color:#65737e>// helperFunction(); // Error: helperFunction is not accessible here
</span><span>
</span><span>    </span><span style=color:#b48ead>return </span><span style=color:#d08770>0</span><span>;
</span><span>}
</span></code></pre><blockquote><p>In this example, <em>helperFunction</em> is defined as static in utils.c, limiting its visibility to that file. <em>publicFunction</em> can call <em>helperFunction</em> within utils.c, but <em>helperFunction</em> is not accessible in main.c, demonstrating the use of static to encapsulate functions within a single source file.</blockquote><h2 id=summary>Summary</h2><table><thead><tr><th>Keyword<th>Lifetime<th>Visibility<tbody><tr><td>static<td>Stored till program ends<td>Accessible only within current file<tr><td>extern<td>Stored till program ends<td>Accessible across different files</table><p class=tags-data><a href=/tags/c>/c/</a></main><footer><hr><footer id=footer><div id=contact-icons><a rel="noopener noreferrer" title="Subscribe via RSS for updates." class=no-style href=atom.xml target=_blank> <span class=iconify data-icon=solar:atom-bold></span> </a><a class=no-style href=mailto:karthikdk1998@gmail.com target=_blank title=Email> <span class=iconify data-icon=mdi:email></span> </a><a rel="noopener noreferrer" class=no-style href=https://github.com/Karthik-d-k target=_blank title=GitHub> <span class=iconify data-icon=mdi:github></span> </a><a rel="noopener noreferrer" class=no-style href=https://x.com/Karthik_d_k target=_blank title=Twitter> <span class=iconify data-icon=mdi:twitter></span> </a><a rel="noopener noreferrer" class=no-style href=https://www.linkedin.com/in/karthik-d-k-319853166 target=_blank title=LinkedIn> <span class=iconify data-icon=mdi:linkedin></span> </a></div><script src=https://code.iconify.design/2/2.2.1/iconify.min.js></script></footer></footer>